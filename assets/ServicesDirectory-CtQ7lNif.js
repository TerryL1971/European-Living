import{j as e}from"./vendor-markdown-CsK2p4zB.js";import{r as d}from"./vendor-react-vjDAwYPo.js";import{a as R,E as C,B as k}from"./ErrorMessage-jatBZSJR.js";import{u as B,b as F,L as A}from"./index-Dxj1fGjv.js";import{v as D,F as E,p as L,S as M,b as O,P,u as Q}from"./vendor-ui-Gn-reG0e.js";import"./vendor-query-DBXCnbMX.js";function T(l,n){return l.filter(r=>{if(n.category&&r.category!==n.category||n.subcategory&&r.subcategory!==n.subcategory||n.city&&r.city?.toLowerCase()!==n.city.toLowerCase()||n.nearbyBase&&!r.basesServed?.includes(n.nearbyBase)||n.englishFluency&&r.englishFluency!==n.englishFluency||n.militaryDiscount&&!r.militaryDiscount||n.sofaFamiliar&&!r.sofaFamiliar)return!1;if(n.priceRange?.length&&r.priceRange){const s=["$","$$","$$$","$$$$"],t=r.priceRange;if(s.includes(t)&&!n.priceRange.includes(t))return!1}if(n.minRating&&(!r.rating||r.rating<n.minRating))return!1;if(n.searchQuery){const s=n.searchQuery.toLowerCase();if(![r.name,r.description,r.city,r.subcategory,...r.tags||[]].filter(Boolean).join(" ").toLowerCase().includes(s))return!1}return!0})}function U(l,n){const r=[...l];switch(n){case"rating-desc":return r.sort((s,t)=>(t.rating||0)-(s.rating||0));case"rating-asc":return r.sort((s,t)=>(s.rating||0)-(t.rating||0));case"price-asc":{const s={$:1,$$:2,$$$:3,$$$$:4};return r.sort((t,i)=>!t.priceRange||!i.priceRange?0:s[t.priceRange]-s[i.priceRange])}case"price-desc":{const s={$:1,$$:2,$$$:3,$$$$:4};return r.sort((t,i)=>!t.priceRange||!i.priceRange?0:s[i.priceRange]-s[t.priceRange])}case"name-asc":return r.sort((s,t)=>s.name.localeCompare(t.name));case"name-desc":return r.sort((s,t)=>t.name.localeCompare(s.name));case"newest":return r.sort((s,t)=>{const i=s.createdAt?new Date(s.createdAt).getTime():0;return(t.createdAt?new Date(t.createdAt).getTime():0)-i});case"featured":return r.sort((s,t)=>s.featured&&!t.featured?-1:!s.featured&&t.featured?1:(t.rating||0)-(s.rating||0));default:return r}}const G=[{id:"all",name:"All Services"},{id:"restaurants",name:"Restaurants"},{id:"shopping",name:"Shopping"},{id:"home-services",name:"Home Services"},{id:"real-estate",name:"Real Estate"},{id:"legal",name:"Legal Services"},{id:"education",name:"Education"},{id:"business",name:"Business Services"}],H=["All Cities","Stuttgart","Kaiserslautern","Wiesbaden","Ramstein"];function V(){const{selectedBase:l}=B(),[n,r]=d.useState(""),[s,t]=d.useState("all"),[i,g]=d.useState("All Cities"),[c,y]=d.useState(!1),[o,f]=d.useState(!1),[m,j]=d.useState(0),[u,v]=d.useState("featured"),{data:h=[],isLoading:N,error:p,refetch:w}=F({baseId:l==="all"?void 0:l}),x=d.useMemo(()=>{const a=T(h,{category:s==="all"?void 0:s,city:i==="All Cities"?void 0:i,searchQuery:n||void 0,militaryDiscount:o||void 0,minRating:m||void 0});return U(a,u)},[h,s,i,n,o,m,u]),S=l&&l!=="all"?e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Showing results near: ",e.jsx("span",{className:"font-semibold text-blue-700",children:l})]}):e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Showing results for: ",e.jsx("span",{className:"font-semibold text-blue-700",children:"All Bases"})]}),$=({service:a})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden border border-gray-200",children:[e.jsx(k,{imageUrl:a?.imageUrl,category:a?.category,businessName:a?.name??"Business",className:"w-full h-48"}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a?.name??"Unnamed Service"}),e.jsx(L,{className:"w-5 h-5 text-[var(--brand-primary)]"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4 fill-[var(--brand-gold)] text-[var(--brand-gold)]"}),e.jsx("span",{className:"font-semibold",children:a?.rating??0}),e.jsxs("span",{children:["(",a?.reviewCount??0,")"]})]}),e.jsx("span",{className:"text-gray-400",children:"â€¢"}),e.jsx("span",{children:a?.priceRange??"N/A"})]})]})}),e.jsx("p",{className:"text-gray-700 mb-4",children:a?.description??"No description available."}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:a?.tags?.map(b=>e.jsx("span",{className:"px-3 py-1 bg-[var(--brand-primary)] bg-opacity-10 text-[var(--brand-dark)] text-sm rounded-full",children:b},b))}),(a?.militaryDiscount||a?.sofaFamiliar)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[a?.militaryDiscount&&e.jsxs("span",{className:"px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full font-medium",children:["ðŸŽ–ï¸ ",a?.discountPercent??0,"% Military Discount"]}),a?.sofaFamiliar&&e.jsx("span",{className:"px-3 py-1 bg-[var(--brand-primary)] bg-opacity-20 text-[var(--brand-dark)] text-sm rounded-full font-medium",children:"âœ“ SOFA Familiar"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 border-t pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-[var(--brand-primary)]"}),e.jsx("span",{children:a?.city??"Unknown City"}),a?.basesServed?.length?e.jsxs("span",{className:"text-gray-400",children:["â€¢ Near ",a.basesServed[0]]}):null]}),a?.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-[var(--brand-primary)]"}),e.jsx("a",{href:`tel:${a.phone}`,className:"text-[var(--brand-primary)] hover:underline",children:a.phone})]}),a?.website&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-[var(--brand-primary)]"}),e.jsx("a",{href:a.website,target:"_blank",rel:"noopener noreferrer",className:"text-[var(--brand-primary)] hover:underline",children:"Visit Website"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("span",{className:"inline-flex items-center px-3 py-1 bg-[var(--brand-primary)] bg-opacity-10 text-[var(--brand-light)] text-sm rounded-full font-medium",children:["ðŸ—£ï¸ ",a?.englishFluency==="fluent"?"Fluent English":"English Spoken"]})})]})]});return e.jsx("div",{className:"min-h-screen bg-[var(--brand-bg)] py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsx(R,{})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-[var(--brand-dark)] mb-2",children:"Services Directory"}),e.jsx("p",{className:"text-lg text-[var(--brand-dark)] opacity-80",children:"English-friendly businesses serving Americans in Germany"}),S]}),p&&e.jsx(C,{title:"Failed to load businesses",message:p.message,onRetry:()=>w()}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(D,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search businesses, services, locations...",value:n,onChange:a=>r(a.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)] focus:border-transparent"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:G.map(a=>e.jsx("button",{onClick:()=>t(a.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${s===a.id?"bg-[var(--brand-primary)] text-white":"bg-gray-100 text-gray-700 hover:bg-[var(--brand-primary)] hover:bg-opacity-10"}`,children:a.name},a.id))}),e.jsxs("button",{onClick:()=>y(!c),className:"flex items-center gap-2 text-[var(--brand-primary)] hover:text-[var(--brand-dark)] font-medium",children:[e.jsx(E,{className:"w-4 h-4"}),c?"Hide":"Show"," Advanced Filters"]}),c&&e.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),e.jsx("select",{value:i,onChange:a=>g(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",children:H.map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),e.jsxs("select",{value:u,onChange:a=>v(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",children:[e.jsx("option",{value:"featured",children:"Featured"}),e.jsx("option",{value:"rating-desc",children:"Highest Rated"}),e.jsx("option",{value:"rating-asc",children:"Lowest Rated"}),e.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),e.jsx("option",{value:"newest",children:"Newest"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Rating"}),e.jsxs("select",{value:m,onChange:a=>j(Number(a.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",children:[e.jsx("option",{value:0,children:"Any Rating"}),e.jsx("option",{value:4,children:"4+ Stars"}),e.jsx("option",{value:4.5,children:"4.5+ Stars"}),e.jsx("option",{value:4.8,children:"4.8+ Stars"})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:a=>f(a.target.checked),className:"w-5 h-5 text-[var(--brand-primary)] rounded focus:ring-2 focus:ring-[var(--brand-primary)]"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Military Discount Only"})]})})]})]}),N?e.jsx(A,{size:"lg",message:"Loading services..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 text-gray-600",children:["Found ",e.jsx("span",{className:"font-semibold",children:x.length})," services"]}),x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(a=>e.jsx($,{service:a},a?.id))}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"No services found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filters"})]})]}),e.jsxs("div",{className:"mt-12 bg-[var(--brand-primary)] bg-opacity-10 border-2 border-[var(--brand-primary)] rounded-lg p-8 text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-[var(--brand-dark)] mb-2",children:"Own a Business?"}),e.jsx("p",{className:"text-[var(--brand-dark)] opacity-80 mb-4",children:"Get your English-friendly business listed to reach American military families"}),e.jsx("button",{onClick:()=>window.location.href="/submit-business",className:"px-6 py-3 bg-[var(--brand-primary)] text-white rounded-lg font-medium hover:bg-[var(--brand-dark)] transition-colors",children:"Add Your Business"})]})]})})}export{V as default};
