import{j as e}from"./vendor-markdown-BC8sZGMk.js";import{r as c}from"./vendor-react-BDu5rya1.js";import{B as R,E as C}from"./ErrorMessage-Ci8saS0X.js";import{u as A,b as F,L as B}from"./index-B9sg1rUp.js";import{w as D,F as k,n as E,x as L,t as M,p as O,u as Q,v as T}from"./vendor-ui-BYUw5mf1.js";import"./vendor-query-DenH8THg.js";function P(i,n){return i.filter(t=>{if(n.category&&t.category!==n.category||n.subcategory&&t.subcategory!==n.subcategory||n.city&&t.city?.toLowerCase()!==n.city.toLowerCase()||n.nearbyBase&&!t.basesServed?.includes(n.nearbyBase)||n.englishFluency&&t.englishFluency!==n.englishFluency||n.militaryDiscount&&!t.militaryDiscount||n.sofaFamiliar&&!t.sofaFamiliar)return!1;if(n.priceRange?.length&&t.priceRange){const a=["$","$$","$$$","$$$$"],r=t.priceRange;if(a.includes(r)&&!n.priceRange.includes(r))return!1}if(n.minRating&&(!t.rating||t.rating<n.minRating))return!1;if(n.searchQuery){const a=n.searchQuery.toLowerCase();if(![t.name,t.description,t.city,t.subcategory,...t.tags||[]].filter(Boolean).join(" ").toLowerCase().includes(a))return!1}return!0})}function G(i,n){const t=[...i];switch(n){case"rating-desc":return t.sort((a,r)=>(r.rating||0)-(a.rating||0));case"rating-asc":return t.sort((a,r)=>(a.rating||0)-(r.rating||0));case"price-asc":{const a={$:1,$$:2,$$$:3,$$$$:4};return t.sort((r,l)=>!r.priceRange||!l.priceRange?0:a[r.priceRange]-a[l.priceRange])}case"price-desc":{const a={$:1,$$:2,$$$:3,$$$$:4};return t.sort((r,l)=>!r.priceRange||!l.priceRange?0:a[l.priceRange]-a[r.priceRange])}case"name-asc":return t.sort((a,r)=>a.name.localeCompare(r.name));case"name-desc":return t.sort((a,r)=>r.name.localeCompare(a.name));case"newest":return t.sort((a,r)=>{const l=a.createdAt?new Date(a.createdAt).getTime():0;return(r.createdAt?new Date(r.createdAt).getTime():0)-l});case"featured":return t.sort((a,r)=>a.featured&&!r.featured?-1:!a.featured&&r.featured?1:(r.rating||0)-(a.rating||0));default:return t}}const H=[{id:"all",name:"All Services"},{id:"restaurants",name:"Restaurants"},{id:"shopping",name:"Shopping"},{id:"home-services",name:"Home Services"},{id:"real-estate",name:"Real Estate"},{id:"legal",name:"Legal Services"},{id:"education",name:"Education"},{id:"business",name:"Business Services"}],U=["All Cities","Stuttgart","Kaiserslautern","Wiesbaden","Ramstein"];function V(){const{selectedBase:i}=A(),[n,t]=c.useState(""),[a,r]=c.useState("all"),[l,g]=c.useState("All Cities"),[d,f]=c.useState(!1),[o,y]=c.useState(!1),[m,j]=c.useState(0),[u,N]=c.useState("featured"),{data:h=[],isLoading:v,error:p,refetch:w}=F({baseId:i==="all"?void 0:i}),x=c.useMemo(()=>{const s=P(h,{category:a==="all"?void 0:a,city:l==="All Cities"?void 0:l,searchQuery:n||void 0,militaryDiscount:o||void 0,minRating:m||void 0});return G(s,u)},[h,a,l,n,o,m,u]),S=i&&i!=="all"?e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Showing results near: ",e.jsx("span",{className:"font-semibold text-blue-700",children:i})]}):e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Showing results for: ",e.jsx("span",{className:"font-semibold text-blue-700",children:"All Bases"})]}),$=({service:s})=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow p-6 border border-gray-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s?.name??"Unnamed Service"}),s?.verified&&e.jsx(E,{className:"w-5 h-5 text-blue-600"}),s?.featured&&e.jsx(L,{className:"w-5 h-5 text-yellow-500"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{className:"font-semibold",children:s?.rating??0}),e.jsxs("span",{children:["(",s?.reviewCount??0,")"]})]}),e.jsx("span",{className:"text-gray-400",children:"â€¢"}),e.jsx("span",{children:s?.priceRange??"N/A"})]})]})}),e.jsx("p",{className:"text-gray-700 mb-4",children:s?.description??"No description available."}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:s?.tags?.map(b=>e.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full",children:b},b))}),(s?.militaryDiscount||s?.sofaFamiliar)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[s?.militaryDiscount&&e.jsxs("span",{className:"px-3 py-1 bg-green-50 text-green-700 text-sm rounded-full font-medium",children:["ðŸŽ–ï¸ ",s?.discountPercent??0,"% Military Discount"]}),s?.sofaFamiliar&&e.jsx("span",{className:"px-3 py-1 bg-purple-50 text-purple-700 text-sm rounded-full font-medium",children:"âœ“ SOFA Familiar"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 border-t pt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{children:s?.city??"Unknown City"}),s?.basesServed?.length?e.jsxs("span",{className:"text-gray-400",children:["â€¢ Near ",s.basesServed[0]]}):null]}),s?.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:`tel:${s.phone}`,className:"text-blue-600 hover:underline",children:s.phone})]}),s?.website&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Visit Website"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("span",{className:"inline-flex items-center px-3 py-1 bg-indigo-50 text-indigo-700 text-sm rounded-full font-medium",children:["ðŸ—£ï¸ ",s?.englishFluency==="fluent"?"Fluent English":"English Spoken"]})})]});return e.jsx("div",{className:"min-h-screen bg-[var(--brand-bg)] py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsx(R,{})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-[var(--brand-dark)] mb-2",children:"Services Directory"}),e.jsx("p",{className:"text-lg text-[var(--brand-dark)] opacity-80",children:"English-friendly businesses serving Americans in Germany"}),S]}),p&&e.jsx(C,{title:"Failed to load businesses",message:p.message,onRetry:()=>w()}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(D,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search businesses, services, locations...",value:n,onChange:s=>t(s.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:H.map(s=>e.jsx("button",{onClick:()=>r(s.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${a===s.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s.name},s.id))}),e.jsxs("button",{onClick:()=>f(!d),className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium",children:[e.jsx(k,{className:"w-4 h-4"}),d?"Hide":"Show"," Advanced Filters"]}),d&&e.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),e.jsx("select",{value:l,onChange:s=>g(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:U.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),e.jsxs("select",{value:u,onChange:s=>N(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"featured",children:"Featured"}),e.jsx("option",{value:"rating-desc",children:"Highest Rated"}),e.jsx("option",{value:"rating-asc",children:"Lowest Rated"}),e.jsx("option",{value:"name-asc",children:"Name (A-Z)"}),e.jsx("option",{value:"name-desc",children:"Name (Z-A)"}),e.jsx("option",{value:"newest",children:"Newest"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Rating"}),e.jsxs("select",{value:m,onChange:s=>j(Number(s.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:0,children:"Any Rating"}),e.jsx("option",{value:4,children:"4+ Stars"}),e.jsx("option",{value:4.5,children:"4.5+ Stars"}),e.jsx("option",{value:4.8,children:"4.8+ Stars"})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:s=>y(s.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"ml-3 text-sm font-medium text-gray-700",children:"Military Discount Only"})]})})]})]}),v?e.jsx(B,{size:"lg",message:"Loading services..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 text-gray-600",children:["Found ",e.jsx("span",{className:"font-semibold",children:x.length})," services"]}),x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>e.jsx($,{service:s},s?.id))}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"No services found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filters"})]})]}),e.jsxs("div",{className:"mt-12 bg-blue-50 border-2 border-blue-200 rounded-lg p-8 text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Own a Business?"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Get your English-friendly business listed to reach American military families"}),e.jsx("button",{onClick:()=>window.location.href="/submit-business",className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Add Your Business"})]})]})})}export{V as default};
