import{j as e}from"./vendor-query-pEaCC0W1.js";import{r as n}from"./vendor-react-DsIc-_p2.js";import{s as g,g as w,c as _,d as C,e as S}from"./index-DAoyNcWz.js";import{S as L}from"./SEO-CReBgAI4.js";import{K as E,X as A,O as D,Z as F,_ as M,$ as z,a0 as I,a1 as U,a2 as O}from"./vendor-ui-CujC0nkv.js";function T({children:u}){const[b,m]=n.useState(null),[v,l]=n.useState(!0),[p,f]=n.useState(""),[i,a]=n.useState(""),[s,o]=n.useState("");n.useEffect(()=>{g.auth.getSession().then(({data:{session:c}})=>{m(c?.user??null),l(!1)});const{data:{subscription:d}}=g.auth.onAuthStateChange((c,h)=>{m(h?.user??null)});return()=>d.unsubscribe()},[]);const j=async d=>{d.preventDefault(),o("");const{error:c}=await g.auth.signInWithPassword({email:p,password:i});c&&o(c.message)},y=async()=>{await g.auth.signOut()};return v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--brand-bg)]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--brand-primary)] mx-auto mb-4"}),e.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Loading..."})]})}):b?e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white border-b border-[var(--border)] px-6 py-3 flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm text-[var(--muted-foreground)]",children:["Logged in as ",e.jsx("strong",{children:b.email})]}),e.jsx("button",{onClick:y,className:"text-sm text-[var(--brand-primary)] hover:text-[var(--brand-dark)] font-semibold",children:"Logout"})]}),u]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--brand-bg)] px-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md w-full",children:[e.jsx("h1",{className:"text-2xl font-bold text-[var(--brand-dark)] mb-6 text-center",children:"Admin Login"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Email"}),e.jsx("input",{type:"email",required:!0,value:p,onChange:d=>f(d.target.value),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)] focus:border-transparent",placeholder:"admin@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Password"}),e.jsx("input",{type:"password",required:!0,value:i,onChange:d=>a(d.target.value),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)] focus:border-transparent",placeholder:"••••••••"})]}),s&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:s}),e.jsx("button",{type:"submit",className:"w-full py-3 bg-[var(--brand-primary)] text-white rounded-lg hover:bg-[var(--brand-dark)] transition font-semibold",children:"Sign In"})]}),e.jsx("p",{className:"text-xs text-[var(--muted-foreground)] text-center mt-6",children:"Contact your administrator if you need access"})]})})}function W(){const[u,b]=n.useState([]),[m,v]=n.useState(!0),[l,p]=n.useState(null),[f,i]=n.useState(!1),[a,s]=n.useState({title:"",description:"",image_url:"",link_url:"",cta_text:"Learn More",type:"article",bases_served:["all"],is_sponsored:!1,sponsor_name:"",active:!0,display_order:1,start_date:"",end_date:""});n.useEffect(()=>{o()},[]);const o=async()=>{v(!0);const r=await w();b(r),v(!1)},j=async r=>{r.preventDefault();const x={title:a.title,description:a.description||void 0,image_url:a.image_url||void 0,link_url:a.link_url||void 0,cta_text:a.cta_text||"Learn More",type:a.type,bases_served:a.bases_served,is_sponsored:a.is_sponsored,sponsor_name:a.is_sponsored&&a.sponsor_name?a.sponsor_name:void 0,active:a.active,display_order:a.display_order,start_date:a.start_date||void 0,end_date:a.end_date||void 0};console.log("Submitting payload:",x);try{let t;l?(console.log("Updating item:",l),t=await _(l,x),console.log("Update result:",t)):(console.log("Creating new item"),t=await C(x),console.log("Create result:",t)),t?(alert(l?"Updated successfully!":"Created successfully!"),N(),o()):alert("Error: Operation failed. Check console for details.")}catch(t){console.error("Error submitting:",t),alert("Error: "+t)}},y=r=>{p(r.id),s({title:r.title,description:r.description||"",image_url:r.image_url||"",link_url:r.link_url||"",cta_text:r.cta_text||"Learn More",type:r.type,bases_served:r.bases_served,is_sponsored:r.is_sponsored||!1,sponsor_name:r.sponsor_name||"",active:r.active,display_order:r.display_order,start_date:r.start_date?r.start_date.split("T")[0]:"",end_date:r.end_date?r.end_date.split("T")[0]:""}),i(!0)},d=async r=>{window.confirm("Are you sure you want to delete this featured content?")&&(await S(r),o())},c=async r=>{await _(r.id,{active:!r.active}),o()},h=async(r,x)=>{const t=x==="up"?r.display_order-1:r.display_order+1;t<1||(await _(r.id,{display_order:t}),o())},N=()=>{s({title:"",description:"",image_url:"",link_url:"",cta_text:"Learn More",type:"article",bases_served:["all"],is_sponsored:!1,sponsor_name:"",active:!0,display_order:u.length+1,start_date:"",end_date:""}),p(null),i(!1)},k=["all","ramstein","spangdahlem","grafenwoehr","stuttgart","wiesbaden"];return e.jsx(T,{children:e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Manage Featured Content - Admin",description:"Manage featured content displayed on the homepage"}),e.jsx("div",{className:"min-h-screen bg-[var(--brand-bg)] py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[var(--brand-dark)] mb-2",children:"Featured Content Manager"}),e.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Manage featured items shown on the homepage"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-[var(--brand-primary)] text-white rounded-lg hover:bg-[var(--brand-dark)] transition",children:[e.jsx(E,{size:20}),"Add Featured Content"]})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-[var(--border)] px-6 py-4 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-2xl font-bold text-[var(--brand-dark)]",children:[l?"Edit":"Add"," Featured Content"]}),e.jsx("button",{onClick:N,className:"text-[var(--muted-foreground)] hover:text-[var(--brand-dark)]",children:e.jsx(A,{size:24})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:a.title,onChange:r=>s({...a,title:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",placeholder:"Stuttgart Christmas Markets 2025"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:r=>s({...a,description:r.target.value}),rows:3,className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",placeholder:"Brief description of the featured content..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Link URL"}),e.jsx("input",{type:"url",value:a.link_url,onChange:r=>s({...a,link_url:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Image URL (optional)"}),e.jsx("input",{type:"url",value:a.image_url,onChange:r=>s({...a,image_url:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",placeholder:"https://example.com/image.jpg"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Type"}),e.jsxs("select",{value:a.type,onChange:r=>s({...a,type:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",children:[e.jsx("option",{value:"article",children:"Article"}),e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"offer",children:"Offer"}),e.jsx("option",{value:"advertisement",children:"Advertisement"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Call-to-Action Text"}),e.jsx("input",{type:"text",value:a.cta_text,onChange:r=>s({...a,cta_text:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",placeholder:"Learn More"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Show for Bases (select at least one) *"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:k.map(r=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.bases_served.includes(r),onChange:x=>{x.target.checked?s({...a,bases_served:[...a.bases_served,r]}):a.bases_served.length>1&&s({...a,bases_served:a.bases_served.filter(t=>t!==r)})},className:"rounded"}),e.jsx("span",{className:"text-sm capitalize",children:r})]},r))}),a.bases_served.length===0&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:"At least one base must be selected"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a.is_sponsored,onChange:r=>s({...a,is_sponsored:r.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold text-[var(--brand-dark)]",children:"This is sponsored content"})]})}),a.is_sponsored&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Sponsor Name"}),e.jsx("input",{type:"text",value:a.sponsor_name,onChange:r=>s({...a,sponsor_name:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]",placeholder:"Sponsor Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Start Date (optional)"}),e.jsx("input",{type:"date",value:a.start_date,onChange:r=>s({...a,start_date:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"End Date (optional)"}),e.jsx("input",{type:"date",value:a.end_date,onChange:r=>s({...a,end_date:r.target.value}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-[var(--brand-dark)] mb-2",children:"Display Order"}),e.jsx("input",{type:"number",min:"1",value:a.display_order,onChange:r=>s({...a,display_order:parseInt(r.target.value)}),className:"w-full px-4 py-2 border border-[var(--border)] rounded-lg focus:ring-2 focus:ring-[var(--brand-primary)]"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer mt-8",children:[e.jsx("input",{type:"checkbox",checked:a.active,onChange:r=>s({...a,active:r.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm font-semibold text-[var(--brand-dark)]",children:"Active (show on site)"})]})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-[var(--brand-primary)] text-white rounded-lg hover:bg-[var(--brand-dark)] transition font-semibold",children:[e.jsx(D,{size:20}),l?"Update":"Create"," Featured Content"]}),e.jsx("button",{type:"button",onClick:N,className:"px-6 py-3 border border-[var(--border)] rounded-lg hover:bg-gray-50 transition",children:"Cancel"})]})]})]})}),m?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-[var(--muted-foreground)]",children:"Loading..."})}):u.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg border border-[var(--border)]",children:[e.jsx("p",{className:"text-[var(--muted-foreground)] mb-4",children:"No featured content yet"}),e.jsx("button",{onClick:()=>i(!0),className:"text-[var(--brand-primary)] hover:text-[var(--brand-dark)] font-semibold",children:"Create your first one"})]}):e.jsx("div",{className:"space-y-4",children:u.map(r=>e.jsx("div",{className:`bg-white rounded-lg border-2 p-6 transition ${r.active?"border-[var(--brand-primary)]":"border-[var(--border)] opacity-60"}`,children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>h(r,"up"),className:"p-2 hover:bg-gray-100 rounded transition",title:"Move up",children:e.jsx(F,{size:20,className:"text-[var(--muted-foreground)]"})}),e.jsx("span",{className:"text-center font-bold text-[var(--brand-dark)]",children:r.display_order}),e.jsx("button",{onClick:()=>h(r,"down"),className:"p-2 hover:bg-gray-100 rounded transition",title:"Move down",children:e.jsx(M,{size:20,className:"text-[var(--muted-foreground)]"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-[var(--brand-dark)] mb-1",children:r.title}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-[var(--muted)] rounded capitalize",children:r.type}),r.is_sponsored&&e.jsxs("span",{className:"text-xs px-2 py-1 bg-[var(--brand-gold)] bg-opacity-30 rounded",children:["Sponsored by ",r.sponsor_name]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-[var(--muted)] rounded",children:r.bases_served.join(", ")})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(r),className:"p-2 hover:bg-gray-100 rounded transition",title:r.active?"Deactivate":"Activate",children:r.active?e.jsx(z,{size:20,className:"text-[var(--brand-primary)]"}):e.jsx(I,{size:20,className:"text-[var(--muted-foreground)]"})}),e.jsx("button",{onClick:()=>y(r),className:"p-2 hover:bg-gray-100 rounded transition",title:"Edit",children:e.jsx(U,{size:20,className:"text-[var(--brand-dark)]"})}),e.jsx("button",{onClick:()=>d(r.id),className:"p-2 hover:bg-red-50 rounded transition",title:"Delete",children:e.jsx(O,{size:20,className:"text-red-600"})})]})]}),e.jsx("p",{className:"text-[var(--muted-foreground)] text-sm mb-2",children:r.description}),r.link_url&&e.jsx("a",{href:r.link_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-[var(--brand-primary)] hover:underline",children:r.link_url}),(r.start_date||r.end_date)&&e.jsxs("p",{className:"text-xs text-[var(--muted-foreground)] mt-2",children:[r.start_date&&`From ${new Date(r.start_date).toLocaleDateString()}`,r.start_date&&r.end_date&&" - ",r.end_date&&`Until ${new Date(r.end_date).toLocaleDateString()}`]})]})]})},r.id))})]})})]})})}export{W as default};
